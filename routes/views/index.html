<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Signin MBT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <!-- Favicons -->


</head>


<body class="m-1 ">
    <nav class="navbar bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="http://localhost:3000/">
                <img src="public/images/logoMaple.png" alt="Logo" width="30" height="24" class="d-inline-block align-text-top"> BookClub MBT
            </a>
        </div>
    </nav>
    <div class="container-sm" style="width: 50%;" id="loginBox">
        <fieldset class="align-items-center">
            <legend class="text-center">Dados de Login</legend>
            <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Email address</label>
                <input type="email" class="form-control" id="InputEmail1" aria-describedby="emailHelp">
            </div>
            <div class="mb-3">
                <label for="exampleInputPassword1" class="form-label">Password</label>
                <input type="password" class="form-control" id="InputPassword1">
            </div>
            <div class="text-center">
                <button type="button" id='postButton' class="btn btn-primary">Log In</button>
                <a class='link-dark' href="http://localhost:3000/register"><button type="button" id='registerButton' class="btn btn-warning ms-5">Não tenho Cadastro</a>
            </div>
        </fieldset>
    </div>
    <div class="container-sm" style="width: 50%;display: none" id="returnBox">
        <h2>Funcionou o login agora vou enxertar botões aqui</h2>
    </div>



</body>

</html>
<script>
    const postButton = document.getElementById('postButton');
    const baseURL = new URL('http://localhost:3000/login/login');
    postButton.addEventListener('click', async() => {
        const email = document.getElementById('InputEmail1').value;
        const password = document.getElementById('InputPassword1').value;
        if (!email) {
            alert("Você precisa digitar um email válido")
            return
        }
        if (!password) {
            alert("Você precisa digitar um password")
            return
        }
        const data = {
            "email": email,
            "password": password
        }
        console.log(data)
        console.log(JSON.stringify(data))
        const response = await getAPIResponse(baseURL, data);
        response.json().then(data => {
            console.log(data);
            if (!data.token) {
                alert(`Houve um erro ao tentar logar no sistema.\nMensagem de erro: ${data.message}`)
                return;
            }
            const loginBox = document.getElementById('loginBox');
            const returnBox = document.getElementById('returnBox');
            loginBox.style.display = 'none';
            returnBox.style.display = 'block';

        })




    })

    async function getAPIResponse(baseURL, data) {
        const response = await fetch(baseURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });
        return response;
    }
</script>

</html>